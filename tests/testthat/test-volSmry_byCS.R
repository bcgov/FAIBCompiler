test_that("volSmry_byCS.R: volumes are not correctly summarized at cluster and species level.", {
  library(data.table)
  library(testthat)
  ## for test for a CMI cluster
  indicluster <- data.table(CLSTR_ID = c("0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", 
                                         "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1", 
                                         "0252-0107-TO1"),  
                            SPECIES = c("YC", "YC", "YC", "YC", "PLC", "YC", 
                                        "YC", "PLC", "YC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", 
                                        "PLC", "PLC", "PLC", "PLI", "PLC", "PLC", "PLC", "PLC", "PLC", 
                                        "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "YC", "PLC", "PLC", 
                                        "PLC", "PLC", "YC", "PLC", "YC", "PLC", "YC", "YC", "YC", 
                                        "YC", "YC", "YC", "YC", "HM", "YC", "YC", "PLC", "PLC", "YC", 
                                        "YC", "PLC", "YC", "YC", "YC", "PLC", "PLC", "PLC", "XC", 
                                        "CW", "CW", "CW", "PLC", "PLC", "PLC", "XC", "PLC", "CW", 
                                        "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "YC", "PLC", "PLC", 
                                        "PLC", "PLC", "YC", "PLC", "YC", "YC", "YC", "YC", "YC", 
                                        "YC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", 
                                        "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", 
                                        "PLC", "PLC", "PLC", "PLC", "PLC", "PLC", "CW", "PLC", "PLC", 
                                        "PLC", "PLC", "PLC", "PLC"), 
                            PHF_TREE = c(100.06724, 
                                         100.06724, 100.06724, 100.06724, 25.01681, 100.06724, 25.01681, 
                                         25.01681, 100.06724, 25.01681, 25.01681, 25.01681, 25.01681, 
                                         25.01681, 25.01681, 25.01681, 100.06724, 100.06724, 100.06724, 
                                         100.06724, 100.06724, 25.01681, 100.06724, 25.01681, 25.01681, 
                                         25.01681, 25.01681, 25.01681, 25.01681, 25.01681, 100.06724, 
                                         25.01681, 25.01681, 100.06724, 25.01681, 100.06724, 25.01681, 
                                         25.01681, 25.01681, 25.01681, 25.01681, 25.01681, 25.01681, 
                                         25.01681, 25.01681, 25.01681, 25.01681, 25.01681, 25.01681, 
                                         25.01681, 25.01681, 100.06724, 100.06724, 25.01681, 100.06724, 
                                         100.06724, 100.06724, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448, 100.06724, 100.06724, 
                                         100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 
                                         100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 
                                         100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 100.06724, 
                                         100.06724, 100.06724, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 200.13448, 
                                         200.13448, 200.13448, 200.13448, 200.13448), 
                            PROJ_ID = c("0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0251", "0251", "0251", "0251", "0251", "0251", "0251", "0251", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252", "0252", "0252", 
                                        "0252", "0252", "0252", "0252", "0252", "0252"),  
                            NO_PLOTS = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5), 
                            LV_D = c("L", "L", 
                                     "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", 
                                     "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", 
                                     "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", "L", 
                                     "L", "L", "L", "D", "D", "D", "D", "L", "L", "D", "D", "L", 
                                     "D", "L", "D", "L", "L", "L", "L", "D", "L", "D", "D", "L", 
                                     "L", "L", "D", "L", "L", "D", "L", "L", "D", "L", "L", "L", 
                                     "D", "D", "L", "L", "L", "L", "L", "L", "L", "D", "D", "D", 
                                     "L", "L", "D", "L", "L", "L", "L", "L", "L", "L", "L", "L", 
                                     "L", "L", "L", "D", "L", "L", "L", "L", "L", "D", "D", "L", 
                                     "L", "L", "L", "L", "D", "L", "L", "L", "L"), 
                            DBH = c(6.1, 5.1, 8.4, 6.9, 22.5, 7.2, 11.4, 23.7, 
                                    7.3, 13.7, 14.7, 9.5, 15.8, 16.2, 10.3, 11.6, 5.8, 7.1, 5.3, 
                                    4.7, 5.1, 10.4, 8.7, 12.1, 14, 23.6, 18.7, 12, 12.2, 10.8, 
                                    7.9, 15, 10.4, 4.5, 12.4, 6.9, 12.9, 11.7, 43, 10.8, 16, 
                                    13.6, 13.5, 11.8, 17.5, 10, 14, 9.3, 12.8, 22.8, 18.2, 5.3, 
                                    6.5, 21.7, 6.7, 7.1, 5.3, 8, 7.2, 12.6, 6.2, 6.2, 4.1, 24.8, 
                                    5.1, 20, 6.8, 4.1, 12.9, 9.6, 7.8, 8.1, 9.9, 5.3, 4.7, 5.2, 
                                    8.1, 4.8, 10.3, 7.4, 5.3, 8, 5.1, 5.7, 6.6, 4.7, 5.5, 7.6, 
                                    9.8, 8.9, 7.9, 12.3, 11.3, 7, 6.5, 4.5, 5.1, 5.3, 5.3, 4.8, 
                                    5.3, 6.5, 6.6, 7.6, 5.5, 5.7, 9, 7.1, 4.4, 5.7, 4.8, 6, 6.2, 
                                    4.7, 7.3, 17.3, 7.4, 8.1, 9.6), 
                            BA_TREE = c(0.002922467, 
                                        0.002042821, 0.005541769, 0.003739281, 0.039760781, 0.004071504, 
                                        0.010207034, 0.044115029, 0.004185387, 0.014741138, 0.016971669, 
                                        0.007088218, 0.019606679, 0.020611989, 0.008332289, 0.010568318, 
                                        0.002642079, 0.003959192, 0.002206183, 0.001734945, 0.002042821, 
                                        0.008494866, 0.005944679, 0.011499014, 0.015393804, 0.043743535, 
                                        0.027464588, 0.011309733, 0.011689866, 0.009160884, 0.00490167, 
                                        0.017671458, 0.008494866, 0.001590431, 0.012076282, 0.003739281, 
                                        0.013069811, 0.010751315, 0.145220118, 0.009160884, 0.020106193, 
                                        0.014526724, 0.014313881, 0.010935884, 0.024052818, 0.007853982, 
                                        0.015393804, 0.006792909, 0.012867963, 0.040828137, 0.026015528, 
                                        0.002206183, 0.003318307, 0.036983613, 0.003525652, 0.003959192, 
                                        0.002206183, 0.005026548, 0.004071504, 0.012468981, 0.00301907, 
                                        0.00301907, 0.001320254, 0.048305128, 0.002042821, 0.031415926, 
                                        0.003631681, 0.001320254, 0.013069811, 0.007238229, 0.004778362, 
                                        0.005152997, 0.007697687, 0.002206183, 0.001734945, 0.002123717, 
                                        0.005152997, 0.001809557, 0.008332289, 0.00430084, 0.002206183, 
                                        0.005026548, 0.002042821, 0.002551759, 0.003421194, 0.001734945, 
                                        0.002375829, 0.00453646, 0.007542964, 0.006221139, 0.00490167, 
                                        0.011882289, 0.010028749, 0.003848451, 0.003318307, 0.001590431, 
                                        0.002042821, 0.002206183, 0.002206183, 0.001809557, 0.002206183, 
                                        0.003318307, 0.003421194, 0.00453646, 0.002375829, 0.002551759, 
                                        0.006361725, 0.003959192, 0.001520531, 0.002551759, 0.001809557, 
                                        0.002827433, 0.00301907, 0.001734945, 0.004185387, 0.023506181, 
                                        0.00430084, 0.005152997, 0.007238229), 
                            HEIGHT = c(4.4, 
                                       4.1, 5.3, 5, 8.1, 4.8, 8.4, 9.1, 5.4, 7.4, 5.8, 4.3, 7.2, 
                                       4.3, 5.5, 5.6, 4.2, 3.1, 2.8, 3.5, 3.8, 6.2, 4.5, 5.8, 8, 
                                       10.2, 9.8, 8.8, 7.3, 5.3, 5.6, 7, 5.4, 3.1, 6.2, 4.8, 10, 
                                       8.1, 13.6, 7.8, 5.8, 10, 9, 8.5, 9.3, 6.8, 9.7, 5.9, 8.8, 
                                       8.5, 5.7, 4.2, 4.4, 8, 4.8, 4.9, 3.9, 2.7, 3.3, 5.8, 4.2, 
                                       3.2, 3.3, 10.7, 2.8, 5.5, 3.4, 2, 5.2, 4.1, 3.2, 2.9, 3.2, 
                                       2.4, 2.2, 2.3, 4.9, 2, 3.1, 2.4, 2.6, 4.4, 3.1, 3.7, 3.9, 
                                       3.4, 4.4, 3.8, 5, 4, 3.3, 4.3, 4.1, 2.9, 2.8, 2.5, 2.4, 2.6, 
                                       2.3, 2.6, 2.2, 2.5, 2.4, 3.4, 2.5, 2.9, 3.9, 3, 2.1, 2.3, 
                                       2.2, 2.7, 3.7, 2.9, 3.4, 5.3, 3.6, 3.5, 3.2),  
                            VOL_WSV = c(0.008796174, 0.006246686, 0.017492664, 0.011687655, 
                                        0.217799246, 0.012407612, 0.043804146, 0.179148225, 0.013544271, 
                                        0.052015624, 0.049689075, 0.016998724, 0.067257798, 0.060686679, 
                                        0.023546466, 0.030226702, 0.006221051, 0.00782094, 0.004156287, 
                                        0.003698371, 0.004540396, 0.02625755, 0.014659674, 0.033714534, 
                                        0.057957094, 0.195316458, 0.120866146, 0.047056916, 0.041026261, 
                                        0.025214383, 0.016078975, 0.05940452, 0.023693523, 0.003199433, 
                                        0.037179715, 0.011458476, 0.061239897, 0.044647239, 0.791897222, 
                                        0.037132215, 0.075314089, 0.071542475, 0.064159158, 0.058086505, 
                                        0.120993292, 0.028793139, 0.06431145, 0.025754328, 0.056863505, 
                                        0.157346999, 0.080592123, 0.006726229, 0.011192546, 0.136225877, 
                                        0.010846234, 0.012208833, 0.006606859, 0.008996284, 0.008341506, 
                                        0.036543458, 0.006193755, 0.006587508, 0.003028147, 0.220328471, 
                                        0.00385956, 0.088882567, 0.007574531, 0.002011428, 0.035513111, 
                                        0.017921426, 0.009600939, 0.00970965, 0.015393502, 0.003723952, 
                                        0.003206033, 0.00399309, 0.015639935, 0.002491561, 0.016297572, 
                                        0.006979336, 0.003963777, 0.014500041, 0.00408117, 0.007416172, 
                                        0.009738964, 0.005316547, 0.007288747, 0.012448359, 0.02265771, 
                                        0.01426689, 0.010029455, 0.028556221, 0.023384731, 0.007297139, 
                                        0.006171351, 0.002835373, 0.003466294, 0.003963777, 0.003576221, 
                                        0.003285507, 0.003405885, 0.005670156, 0.005622523, 0.009451735, 
                                        0.004130244, 0.004886366, 0.014369846, 0.007665826, 0.002300187, 
                                        0.004091784, 0.002845048, 0.005158853, 0.007260457, 0.003363771, 
                                        0.008723411, 0.064800167, 0.009263254, 0.010915458, 0.014483965),
                            VOL_NET = c(0.008796174, 0.006246686, 0.017492664, 0.011687655, 
                                        0.217799246, 0.012407612, 0.043804146, 0.179148225, 0.013544271, 
                                        0.052015624, 0.049689075, 0.016148788, 0.067257798, 0.060686679, 
                                        0.023546466, 0.030226702, 0.006221051, 0.00782094, 0.004156287, 
                                        0.003698371, 0.004540396, 0.02625755, 0.014659674, 0.033714534, 
                                        0.057957094, 0.195316458, 0.120866146, 0.047056916, 0.041026261, 
                                        0.025214383, 0.016078975, 0.05940452, 0.023693523, 0.003199433, 
                                        0.037179715, 0.011458476, 0.061239897, 0.044647239, 0.791897222, 
                                        0.037132215, 0.075314089, 0.070111625, 0.057743242, 0.055182179, 
                                        0.114943627, 0.028793139, 0.06431145, 0.025496785, 0.05629487, 
                                        0.157346999, 0.079786202, 0.006726229, 0.011192546, 0.136225877, 
                                        0.010846234, 0.012208833, 0.006606859, 0, 0, 0.035048241, 
                                        0, 0, 0.003028147, 0.204539792, 0, 0.088336292, 0, 0.001307428, 
                                        0.035294846, 0, 0, 0.009612553, 0.015239567, 0.003537754, 
                                        0.003045731, 0.003953159, 0, 0, 0.016197406, 0, 0, 0.014500041, 
                                        0, 0, 0, 0.005316547, 0, 0, 0, 0, 0, 0.028380713, 0.023241008, 
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                        0, 0, 0, 0.064401903, 0, 0, 0), 
                            VOL_MER = c(0, 0, 0.001726766, 
                                        0, 0.201673103, 0, 0.020294429, 0.155353687, 0, 0.034102546, 
                                        0.035199119, 0.000784978, 0.050616399, 0.047737249, 0.006948689, 
                                        0.015231149, 0, 0, 0, 0, 0, 0.00778745, 0, 0.01908264, 0.039394544, 
                                        0.17098872, 0.099869355, 0.023826158, 0.021954709, 0.010216859, 
                                        0, 0.043059637, 0.007907533, 0, 0.021710717, 0, 0.036469529, 
                                        0.022069773, 0.732991885, 0.015255632, 0.05725662, 0.047202192, 
                                        0.041467217, 0.028917202, 0.0982221, 0.008791607, 0.044280026, 
                                        0.005429855, 0.034303074, 0.135053707, 0.06449162, 0, 0, 
                                        0.115877491, 0, 0, 0, 0, 0, 0.021544427, 0, 0, 0, 0.191190231, 
                                        0, 0.072679607, 0, 0, 0.022478313, 0.004329118, 0, 0, 0.00589358, 
                                        0, 0, 0, 0.000847387, 0, 0.00803711, 0, 0, 0.000848531, 0, 
                                        0, 0, 0, 0, 0, 0.00789587, 0, 0, 0.017211251, 0.012255829, 
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                        0, 0, 0, 0.050810305, 0, 0, 0.004031803), 
                            VOL_NETM = c(0, 
                                         0, 0.001726766, 0, 0.201673103, 0, 0.020294429, 0.155353687, 
                                         0, 0.034102546, 0.035199119, 0.000745729, 0.050616399, 0.047737249, 
                                         0.006948689, 0.015231149, 0, 0, 0, 0, 0, 0.00778745, 0, 0.01908264, 
                                         0.039394544, 0.17098872, 0.099869355, 0.023826158, 0.021954709, 
                                         0.010216859, 0, 0.043059637, 0.007907533, 0, 0.021710717, 
                                         0, 0.036469529, 0.022069773, 0.732991885, 0.015255632, 0.05725662, 
                                         0.046258148, 0.037320496, 0.027471342, 0.093310995, 0.008791607, 
                                         0.044280026, 0.005375556, 0.033960043, 0.135053707, 0.063846704, 
                                         0, 0, 0.115877491, 0, 0, 0, 0, 0, 0.033384301, 0, 0, 0, 0.193040761, 
                                         0, 0.083140725, 0, 0, 0.033218953, 0, 0, 0, 0.005834644, 
                                         0, 0, 0, 0, 0, 0.015244743, 0, 0, 0.000848531, 0, 0, 0, 0, 
                                         0, 0, 0, 0, 0, 0.02671148, 0.02187407, 0, 0, 0, 0, 0, 0, 
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.060614056, 
                                         0, 0, 0), 
                            VOL_NTW2 = c(0, 0, 0.001726766, 0, 0.201673103, 
                                         0, 0.020294429, 0.155353687, 0, 0.034102546, 0.035199119, 
                                         0.000745729, 0.050616399, 0.047737249, 0.006948689, 0.015231149, 
                                         0, 0, 0, 0, 0, 0.00778745, 0, 0.01908264, 0.039394544, 0.17098872, 
                                         0.099869355, 0.023826158, 0.021954709, 0.010216859, 0, 0.043059637, 
                                         0.007907533, 0, 0.021710717, 0, 0.036469529, 0.022069773, 
                                         0.732991885, 0.015255632, 0.05725662, 0.046258148, 0.037320496, 
                                         0.027471342, 0.093310995, 0.008791607, 0.044280026, 0.005375556, 
                                         0.033960043, 0.135053707, 0.063846704, 0, 0, 0.115877491, 
                                         0, 0, 0, 0, 0, 0.033384301, 0, 0, 0, 0.192749098, 0, 0.083140725, 
                                         0, 0, 0.033218953, 0, 0, 0, 0.005834644, 0, 0, 0, 0, 0, 0.015244743, 
                                         0, 0, 0.000848531, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.02671148, 
                                         0.02187407, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                         0, 0, 0, 0, 0, 0, 0, 0.060614056, 0, 0, 0), 
                            VOL_NTWB = c(0, 
                                         0, 0.001605893, 0, 0.197639641, 0, 0.018873819, 0.152246613, 
                                         0, 0.033420495, 0.034495137, 0.000730029, 0.049604071, 0.046782504, 
                                         0.006809715, 0.014926526, 0, 0, 0, 0, 0, 0.007631701, 0, 
                                         0.018700987, 0.038606653, 0.167568946, 0.097871968, 0.023349635, 
                                         0.021515615, 0.010012522, 0, 0.042198445, 0.007749382, 0, 
                                         0.021276503, 0, 0.035740138, 0.020524889, 0.718332047, 0.014187738, 
                                         0.053248657, 0.042953995, 0.034417791, 0.025447138, 0.086435448, 
                                         0.008176195, 0.042066025, 0.004995466, 0.031558828, 0.132352633, 
                                         0.062556871, 0, 0, 0.113559941, 0, 0, 0, 0, 0, 0.032688383, 
                                         0, 0, 0, 0.178523219, 0, 0.081467804, 0, 0, 0.032550535, 
                                         0, 0, 0, 0.005716772, 0, 0, 0, 0, 0, 0.014937995, 0, 0, 0.000789134, 
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0.026174003, 0.02143393, 0, 0, 
                                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                         0, 0.059394406, 0, 0, 0), 
                            VOL_D = c(0, 0, 0.001720438, 0, 
                                      0.188238377, 0, 0.020220054, 0.144809416, 0, 0.033346943, 
                                      0.034377106, 0.000767585, 0.049338882, 0.046499586, 0.006794728, 
                                      0.014893676, 0, 0, 0, 0, 0, 0.007614905, 0, 0.01865983, 0.038521688, 
                                      0.164363714, 0.096849426, 0.023298247, 0.021468263, 0.009990486, 
                                      0, 0.040582359, 0.007454815, 0, 0.020467749, 0, 0.035661481, 
                                      0.021988891, 0.686597529, 0.015199723, 0.057046784, 0.047029204, 
                                      0.041315247, 0.028811225, 0.097862133, 0.008759388, 0.044141419, 
                                      0.005409955, 0.034177359, 0.130009022, 0.062597218, 0, 0, 
                                      0.111770711, 0, 0, 0, 0, 0, 0.032719735, 0, 0, 0, 0.199262535, 
                                      0, 0.07767859, 0, 0, 0.031036551, 0, 0, 0, 0.005683844, 0, 
                                      0, 0, 0, 0, 0.014243202, 0, 0, 0.000845422, 0, 0, 0, 0, 0, 
                                      0, 0, 0, 0, 0.024956603, 0.020436999, 0, 0, 0, 0, 0, 0, 0, 
                                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.056631866, 
                                      0, 0, 0), 
                            VOL_DW = c(0, 0, 0.001717749, 0, 0.182526281, 0, 
                                       0.020200542, 0.140471955, 0, 0.033114523, 0.034076498, 0.000761892, 
                                       0.048901195, 0.045919944, 0.006748381, 0.014784982, 0, 0, 
                                       0, 0, 0, 0.007566002, 0, 0.018522549, 0.038260912, 0.161865927, 
                                       0.095870554, 0.023163044, 0.021328504, 0.009918739, 0, 0.039708541, 
                                       0.007311522, 0, 0.020059173, 0, 0.035459412, 0.021965623, 
                                       0.664437558, 0.015183918, 0.056905662, 0.046989157, 0.041273068, 
                                       0.028782989, 0.097738494, 0.008748695, 0.044100893, 0.005402135, 
                                       0.034143034, 0.127990684, 0.061788974, 0, 0, 0.110133077, 
                                       0, 0, 0, 0, 0, 0.031930019, 0, 0, 0, 0.194948171, 0, 0.075181702, 
                                       0, 0, 0.030038918, 0, 0, 0, 0.005598355, 0, 0, 0, 0, 0, 0.013785371, 
                                       0, 0, 0.00084372, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.024154402, 
                                       0.019780076, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                       0, 0, 0, 0, 0, 0, 0, 0.054811501, 0, 0, 0), 
                            VOL_DWB = c(0, 
                                        0, 0.001596876, 0, 0.178492819, 0, 0.018779932, 0.137364881, 
                                        0, 0.032432472, 0.033372516, 0.000746192, 0.047888867, 0.044965199, 
                                        0.006609407, 0.014480359, 0, 0, 0, 0, 0, 0.007410253, 0, 
                                        0.018140896, 0.037473022, 0.158446153, 0.093873167, 0.02268652, 
                                        0.02088941, 0.009714401, 0, 0.038847348, 0.007153371, 0, 
                                        0.019624959, 0, 0.034730021, 0.020420739, 0.64977772, 0.014116024, 
                                        0.052897699, 0.043685003, 0.038370363, 0.026758785, 0.090862947, 
                                        0.008133283, 0.041886891, 0.005022046, 0.031741819, 0.12528961, 
                                        0.060499141, 0, 0, 0.107815527, 0, 0, 0, 0, 0, 0.031234101, 
                                        0, 0, 0, 0.180667299, 0, 0.073508781, 0, 0, 0.029370501, 
                                        0, 0, 0, 0.005480483, 0, 0, 0, 0, 0, 0.013478623, 0, 0, 0.000784322, 
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0.023616926, 0.019339935, 0, 0, 
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                        0, 0.053591851, 0, 0, 0), 
                            VAL_MER = c(0, 0, 0.017267664, 
                                        0, 5.041827568, 0, 0.202944291, 3.107073735, 0, 0.34102546, 
                                        0.351991189, 0.007849778, 0.506163987, 0.477372493, 0.069486886, 
                                        0.152311489, 0, 0, 0, 0, 0, 0.077874497, 0, 0.190826403, 
                                        0.393945444, 4.274717998, 2.496733877, 0.238261583, 0.219547093, 
                                        0.102168587, 0, 0.430596373, 0.079075327, 0, 0.217107174, 
                                        0, 0.36469529, 0.551744333, 18.027447086, 0.152556323, 0.5725662, 
                                        0.708032876, 0.207336087, 0.14458601, 1.473331499, 0.087916073, 
                                        0.885600527, 0.027149273, 0.17151537, 2.70107414, 0.644916198, 
                                        0, 0, 2.317549823, 0, 0, 0, 0, 0, 0.77197559, 0, 0, 0, 30.38969921, 
                                        0, 3.884086744, 0, 0, 1.551890401, 0, 0, 0, 0.058935798, 
                                        0, 0, 0, 0, 0, 0.71218895, 0, 0, 0.021213284, 0, 0, 0, 0, 
                                        0, 0, 0, 0, 0, 1.247880687, 1.021891335, 0, 0, 0, 0, 0, 0, 
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.831707931, 
                                        0, 0, 0), 
                            SF_COMPILE = c("S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", "S", 
                                           "S", "S", "S", "S"), 
                            PLOT_DED = c(1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                         1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 
                                         5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5), 
                            BGC_ZONE = c("CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", 
                                         "CWH"))
  
  volsummaries <- volSmry_byCS(treeMC = data.table::copy(indicluster), utilLevel = 4, weirdUtil = "no", equation = "KBEC")
  volsummaries <- volsummaries[order(UTIL, CLSTR_ID, SPECIES)]
  ## compare summaries one by one
  # 1. for utilization levels
  expect_equal(volsummaries$UTIL, c(4, 4, 4, 4, 4, 4, 4, 4, 7.5, 7.5, 7.5, 7.5, 7.5, 
                                    7.5, 12.5, 12.5, 12.5, 12.5, 12.5, 17.5, 17.5, 17.5, 17.5, 22.5, 
                                    22.5))
  # 2. for number of trees
  expect_equal(volsummaries$NO_TREES,
               c(1, 31, 1, 24, 5, 47, 2, 8, 1, 26, 13, 2, 17, 4, 1, 15, 5, 1, 
                 4, 8, 1, 1, 1, 5, 1))
  # 3. for whole stem volume
  expect_equal(volsummaries$VHA_WSV,
               c(1.609, 66.853, 0.416, 19.165, 10.212, 15.896, 0, 
                 0.998, 1.609, 64.303, 9.106, 9.536, 11.897, 0.852, 1.609, 55.208, 
                 1.884, 8.819, 7.573, 44.995, 0, 8.819, 3.558, 38.564, 8.819))
  # 4. for vha_net
  expect_equal(volsummaries$VHA_NET,
               c(1.609, 66.832, 0.416, 19.165, 8.308, 9.452, 0, 0.29, 
                 1.609, 64.282, 9.106, 8.187, 9.381, 0.29, 1.609, 55.208, 1.884, 
                 8.187, 7.526, 44.995, 0, 8.187, 3.536, 38.564, 8.187))
  # 5. for vha_mer
  expect_equal(volsummaries$VHA_MER,
               c(1.108, 50.88, 0, 3.267, 7.826, 6.873, 0, 0.034, 1.108, 
                 50.88, 3.267, 7.826, 6.873, 0.034, 1.108, 47.492, 1.432, 7.653, 
                 5.843, 40.322, 0, 7.653, 2.909, 34.925, 7.653))
  # 6. for vha_netm
  expect_equal(volsummaries$VHA_NETM,
               c(1.108, 50.879, 0, 3.267, 7.727, 8.478, 0, 0.017, 
                 1.108, 50.879, 3.267, 7.727, 8.478, 0.017, 1.108, 47.492, 1.432, 
                 7.727, 7.084, 40.322, 0, 7.727, 3.328, 34.925, 7.727))
  # 7. for VHA_NTW2
  expect_equal(volsummaries$VHA_NTW2,
               c(1.108, 50.879, 0, 3.267, 7.715, 8.478, 0, 0.017, 
                 1.108, 50.879, 3.267, 7.715, 8.478, 0.017, 1.108, 47.492, 1.432, 
                 7.715, 7.084, 40.322, 0, 7.715, 3.328, 34.925, 7.715))
  # 8. for VHA_NTWB
  expect_equal(volsummaries$VHA_NTWB,
               c(1.052, 49.862, 0, 3.038, 7.146, 8.307, 0, 0.016, 
                 1.052, 49.862, 3.038, 7.146, 8.307, 0.016, 1.052, 46.542, 1.332, 
                 7.146, 6.941, 39.516, 0, 7.146, 3.261, 34.226, 7.146))
  # 9. for VHA_D
  expect_equal(volsummaries$VHA_D,
               c(1.104, 48.342, 0, 3.255, 7.976, 7.926, 0, 0.017, 
                 1.104, 48.342, 3.255, 7.976, 7.926, 0.017, 1.104, 45.054, 1.427, 
                 7.976, 6.618, 38.092, 0, 7.976, 3.109, 32.873, 7.976))
  # 10. for VHA_DW
  expect_equal(volsummaries$VHA_DW,
               c(1.103, 47.254, 0, 3.249, 7.803, 7.673, 0, 0.017, 
                 1.103, 47.254, 3.249, 7.803, 7.673, 0.017, 1.103, 43.998, 1.424, 
                 7.803, 6.406, 37.107, 0, 7.803, 3.009, 31.954, 7.803))
  # 11. for VHA_DWB
  expect_equal(volsummaries$VHA_DWB,
               c(1.048, 46.237, 0, 3.02, 7.232, 7.502, 0, 0.016, 1.048, 
                 46.237, 3.02, 7.232, 7.502, 0.016, 1.048, 43.048, 1.323, 7.232, 
                 6.263, 36.301, 0, 7.232, 2.942, 31.255, 7.232))
  # 12. for DHA_MER
  expect_equal(volsummaries$DHA_MER,
               c(22.155, 1055.377, 0, 40.947, 1216.405, 391.789, 0, 
                 0.425, 22.155, 1055.377, 40.947, 1216.405, 391.789, 0.425, 22.155, 
                 1021.492, 14.324, 1216.405, 330.93, 949.799, 0, 1216.405, 155.468, 
                 829.361, 1216.405))
  # 13. for BA_HA
  expect_equal(volsummaries$BA_HA,
               c(0.385, 16.675, 0.221, 5.76, 2.518, 6.932, 0, 0.342, 
                 0.385, 15.477, 2.498, 2.223, 4.739, 0.295, 0.385, 12.413, 0.503, 
                 1.934, 2.722, 9.459, 0, 1.934, 1.257, 7.847, 1.934))
  # 14 for STEMS_HA
  expect_equal(volsummaries$STEMS_HA,
               c(25, 1201, 100, 1326, 200, 1241, 0, 80, 25, 700, 325, 
                 80, 420, 60, 25, 350, 25, 40, 120, 175, 0, 40, 40, 125, 40))
  # 15 for VHA_WSVLF
  expect_equal(volsummaries$VHA_WSVLF, rep(0, 25))
  # 16 for VHA_NETLF
  expect_equal(volsummaries$VHA_NETLF, rep(0, 25))
  # 17 for VHA_MERLF
  expect_equal(volsummaries$VHA_MERLF, rep(0, 25))
  # 18 for VHA_NETMLF
  expect_equal(volsummaries$VHA_NETMLF, rep(0, 25))
  # 19 for VHA_NTW2LF
  expect_equal(volsummaries$VHA_NTW2LF, rep(0, 25))
  # 20 for VHA_NTWBLF
  expect_equal(volsummaries$VHA_NTWBLF, rep(0, 25))
  # 21 for VHA_DLF
  expect_equal(volsummaries$VHA_DLF, rep(0, 25))
  # 22 for VHA_DWLF
  expect_equal(volsummaries$VHA_DWLF, rep(0, 25))
  # 23 for VHA_DWBLF
  expect_equal(volsummaries$VHA_DWBLF, rep(0, 25))
  # 24 for DHA_MERLF
  expect_equal(volsummaries$DHA_MERLF, rep(0, 25))
  # 25 for BA_HALF
  expect_equal(volsummaries$BA_HALF, rep(0, 25))
  # 26 STEMS_HALF
  expect_equal(volsummaries$STEMS_HALF, rep(0, 25))
# 27 for VHA_WSVDS
  expect_equal(volsummaries$VHA_WSVDS,
               c(0, 2.016, 0, 11.062, 0, 3.481, 0.328, 0.903, 0, 2.016, 
                 9.942, 0, 2.207, 0.453, 0, 2.016, 7.844, 0, 1.463, 2.016, 3.027, 
                 0, 0, 0, 0))
  # 28 for VHA_NETDS
  expect_equal(volsummaries$VHA_NETDS, 
               c(0, 1.996, 0, 10.621, 0, 1.543, 0.052, 0.106, 0, 1.996, 
                 9.501, 0, 1.403, 0, 0, 1.996, 7.482, 0, 1.403, 1.996, 2.876, 
                 0, 0, 0, 0))
  # 29 for VHA_MERDS
  expect_equal(volsummaries$VHA_MERDS,
               c(0, 1.613, 0, 6.393, 0, 0.862, 0, 0.158, 0, 1.613, 
                 6.393, 0, 0.862, 0.158, 0, 1.613, 5.534, 0, 0.862, 1.613, 2.457, 
                 0, 0, 0, 0))
  # 30 for VHA_NETMDS
  expect_equal(volsummaries$VHA_NETMDS,
               c(0, 1.597, 0, 6.097, 0, 1.336, 0, 0, 0, 1.597, 6.097, 
                 0, 1.336, 0, 0, 1.597, 5.275, 0, 1.336, 1.597, 2.334, 0, 0, 0, 
                 0))
  # 31 for VHA_NTW2DS 
  expect_equal(volsummaries$VHA_NTW2DS,
               c(0, 1.597, 0, 6.097, 0, 1.336, 0, 0, 0, 1.597, 6.097, 
                 0, 1.336, 0, 0, 1.597, 5.275, 0, 1.336, 1.597, 2.334, 0, 0, 0, 
                 0))
  # 32 for VHA_NTWBDS
  expect_equal(volsummaries$VHA_NTWBDS,
               c(0, 1.565, 0, 5.649, 0, 1.308, 0, 0, 0, 1.565, 5.649, 
                 0, 1.308, 0, 0, 1.565, 4.887, 0, 1.308, 1.565, 2.162, 0, 0, 0, 
                 0))
  # 33 for VHA_DDS
  expect_equal(volsummaries$VHA_DDS,
               c(0, 1.566, 0, 6.369, 0, 1.31, 0, 0, 0, 1.566, 6.369, 
                 0, 1.31, 0, 0, 1.566, 5.513, 0, 1.31, 1.566, 2.448, 0, 0, 0, 
                 0))
  # 34 for VHA_DWDS
  expect_equal(volsummaries$VHA_DWDS,
               c(0, 1.546, 0, 6.362, 0, 1.278, 0, 0, 0, 1.546, 6.362, 
                 0, 1.278, 0, 0, 1.546, 5.507, 0, 1.278, 1.546, 2.445, 0, 0, 0, 
                 0))
  # 35 for VHA_DWBDS
  expect_equal(volsummaries$VHA_DWBDS,
               c(0, 1.513, 0, 5.915, 0, 1.25, 0, 0, 0, 1.513, 5.915, 
                 0, 1.25, 0, 0, 1.513, 5.12, 0, 1.25, 1.513, 2.273, 0, 0, 0, 0))
  # 36 for DHA_MERDS
  expect_equal(volsummaries$DHA_MERDS,
               c(0, 16.134, 0, 68.345, 0, 30.9, 0, 0, 0, 16.134, 68.345, 
                 0, 30.9, 0, 0, 16.134, 64.048, 0, 30.9, 16.134, 36.858, 0, 0, 
                 0, 0))
  # 37 for BA_HADS
  expect_equal(volsummaries$BA_HADS,
               c(0, 0.651, 0, 2.421, 0, 1.57, 0.174, 0.305, 0, 0.651, 
                 2.089, 0, 0.892, 0.151, 0, 0.651, 1.645, 0, 0.499, 0.651, 0.602, 
                 0, 0, 0, 0))
  # 38 for STEMS_HADS
  expect_equal(volsummaries$STEMS_HADS,
               c(0, 25, 0, 250, 0, 360, 80, 80, 0, 25, 150, 0, 120, 
                 20, 0, 25, 100, 0, 40, 25, 25, 0, 0, 0, 0))
  # 39 for all the outputs of dead falling trees
  attris <- c("VHA_WSVDF", "VHA_NETDF", "VHA_MERDF", "VHA_NETMDF",
              "VHA_NTW2DF", "VHA_NTWBDF", "VHA_DDF",    "VHA_DWDF",   "VHA_DWBDF", 
              "DHA_MERDF",  "BA_HADF", "STEMS_HADF")
  for(i in attris){
  expect_equal(as.numeric(unlist(volsummaries[,i, with = FALSE])), rep(0, 25))
  }
  # 40 for QMD
  expect_equal(volsummaries$QMD,
               c(14, 13.297, 5.3, 7.437, 12.656, 8.434, 0, 7.376, 
                 14, 16.773, 9.889, 18.804, 11.982, 7.903, 14, 21.243, 16, 24.8, 
                 16.987, 26.225, 0, 24.8, 20, 28.262, 24.8))
  # 41 for QMDLF
  expect_equal(volsummaries$QMDLF, rep(0, 25))
  # 42 for QMDDS
  expect_equal(volsummaries$QMDDS,
               c(0, 18.2, 0, 11.1, 0, 7.45, 5.256, 6.967, 0, 18.2, 
                 13.311, 0, 9.723, 9.8, 0, 18.2, 14.468, 0, 12.6, 18.2, 17.5, 
                 0, 0, 0, 0))
  # 43 for QMDDF
  expect_equal(volsummaries$QMDDF, rep(0, 25))
  
  
  ## test defaults
  volsummaries2 <- volSmry_byCS(treeMC = data.table::copy(indicluster))
  volsummaries2 <- volsummaries2[order(UTIL, CLSTR_ID, SPECIES),]
  expect_equal(volsummaries, volsummaries2)
  
  ## test utilLevel
  volsummaries3 <- volSmry_byCS(treeMC = data.table::copy(indicluster), utilLevel = 1, weirdUtil = "no", equation = "KBEC")
  volsummaries4 <- volsummaries2[UTIL %in% c(4, 7.5)]
  volsummaries4 <- volsummaries4[order(UTIL, CLSTR_ID, SPECIES)]
  expect_equal(volsummaries3[order(UTIL, CLSTR_ID, SPECIES)], volsummaries4)
  
  ## test weirdUtil
  volsummaries5 <- volSmry_byCS(treeMC = data.table::copy(indicluster), utilLevel = 1, weirdUtil = 10, equation = "KBEC")
  volsummaries6 <- data.table(CLSTR_ID = c("0251-0001-MO1", "0251-0001-MO1", 
                                           "0251-0001-MO1", "0252-0107-TO1", "0252-0107-TO1"), 
                              SPECIES = c("HM", "PLC", "YC", "CW", "PLC"), 
                              PRJ_GRP = c("Haida Gwaii", "Haida Gwaii", 
                                          "Haida Gwaii", "Haida Gwaii", "Haida Gwaii"), 
                              NO_PLOTS = c(1, 1, 1, 5, 5), 
                              PLOT_DED = c(1, 1, 1, 5, 5), 
                              PROJ_ID = c("0251", "0251", "0251", "0252", "0252"), 
                              BGC_ZONE = c("CWH", "CWH", "CWH", "CWH", "CWH"), 
                              VHA_WSV = c(1.609, 62.411, 5.746, 8.819, 8.939), 
                              VHA_NET = c(1.609, 62.411, 5.746, 8.187, 8.884), 
                              VHA_MER = c(1.108, 50.86, 3.094, 7.653, 6.593), 
                              VHA_NETM = c(1.108, 50.86, 3.094, 7.727, 8.361), 
                              VHA_NTW2 = c(1.108, 50.86, 3.094, 7.715, 8.361), 
                              VHA_NTWB = c(1.052, 49.843, 2.877, 7.146, 8.193), 
                              VHA_D = c(1.104, 48.323, 3.082, 7.976, 7.812), 
                              VHA_DW = c(1.103, 47.235, 3.077, 7.803, 7.561), 
                              VHA_DWB = c(1.048, 46.218, 2.861, 7.232, 7.393), 
                              DHA_MER = c(22.155, 1055.181, 39.22, 1216.405, 390.609), 
                              DBH2 = c(4903.295, 187231.06, 18499.681, 24618.142, 42357.862), 
                              BA_HA = c(0.385, 14.705, 1.453, 1.934, 3.327), 
                              STEMS_HA = c(25, 575, 125, 40, 180), 
                              VHA_WSVLF = c(0, 0, 0, 0, 0), 
                              VHA_NETLF = c(0, 0, 0, 0, 0), 
                              VHA_MERLF = c(0, 0, 0, 0, 0), 
                              VHA_NETMLF = c(0, 0, 0, 0, 0), 
                              VHA_NTW2LF = c(0, 0, 0, 0, 0), 
                              VHA_NTWBLF = c(0, 0, 0, 0, 0), 
                              VHA_DLF = c(0, 0, 0, 0, 0), 
                              VHA_DWLF = c(0, 0, 0, 0, 0), 
                              VHA_DWBLF = c(0, 0, 0, 0, 0), 
                              DHA_MERLF = c(0, 0, 0, 0, 0), 
                              DBH2LF = c(0, 0, 0, 0, 0), 
                              BA_HALF = c(0, 0, 0, 0, 0), 
                              STEMS_HALF = c(0, 0, 0, 0, 0), 
                              VHA_WSVDS = c(0, 2.016, 9.297, 0, 1.463), 
                              VHA_NETDS = c(0, 1.996, 8.863, 0, 1.403), 
                              VHA_MERDS = c(0, 1.613, 6.257, 0, 0.862), 
                              VHA_NETMDS = c(0, 1.597, 5.962, 0, 1.336), 
                              VHA_NTW2DS = c(0, 1.597, 5.962, 0, 1.336), 
                              VHA_NTWBDS = c(0, 1.565, 5.524, 0, 1.308), 
                              VHA_DDS = c(0, 1.566, 6.234, 0, 1.31), 
                              VHA_DWDS = c(0, 1.546, 6.227, 0, 1.278), 
                              VHA_DWBDS = c(0, 1.513, 5.789, 0, 1.25), 
                              DHA_MERDS = c(0, 16.134, 67.666, 0, 30.9), 
                              DBH2DS = c(0, 8286.568, 24429.916, 0, 6354.67), 
                              BA_HADS = c(0, 0.651, 1.919, 0, 0.499), 
                              STEMS_HADS = c(0, 25, 125, 0, 40), 
                              VHA_WSVDF = c(0, 0, 0, 0, 0), 
                              VHA_NETDF = c(0, 0, 0, 0, 0), 
                              VHA_MERDF = c(0, 0, 0, 0, 0), 
                              VHA_NETMDF = c(0, 0, 0, 0, 0), 
                              VHA_NTW2DF = c(0, 0, 0, 0, 0), 
                              VHA_NTWBDF = c(0, 0, 0, 0, 0), 
                              VHA_DDF = c(0, 0, 0, 0, 0), 
                              VHA_DWDF = c(0, 0, 0, 0, 0), 
                              VHA_DWBDF = c(0, 0, 0, 0, 0), 
                              DHA_MERDF = c(0, 0, 0, 0, 0), 
                              DBH2DF = c(0, 0, 0, 0, 0), 
                              BA_HADF = c(0, 0, 0, 0, 0), 
                              STEMS_HADF = c(0, 0, 0, 0, 0), 
                              UTIL = c(10, 10, 10, 10, 10), 
                              QMD = c(14, 18.039, 12.161, 24.8, 15.335), 
                              QMDLF = c(0, 0, 0, 0, 0), 
                              QMDDS = c(0, 18.2, 13.975, 0, 12.6), 
                              QMDDF = c(0, 0, 0, 0, 0), 
                              NO_TREES = c(1, 24, 10, 1, 7))
  volsummaries6 <- rbind(volsummaries3, volsummaries6)
  expect_equal(volsummaries5[order(UTIL, CLSTR_ID, SPECIES)], volsummaries6[order(UTIL, CLSTR_ID, SPECIES)])
  
})