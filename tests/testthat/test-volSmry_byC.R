test_that("volSmry_byC.R: volumes are not correctly summarized at cluster level.", {
  library(data.table)
  library(testthat)
  teptable <- data.table(CLSTR_ID = c("0251-0001-MO1", "0251-0001-MO1",
                                      "0251-0001-MO1", "0251-0001-MO1", "0252-0107-TO1", "0252-0107-TO1",
                                      "0252-0107-TO1", "0252-0107-TO1", "0251-0001-MO1", "0251-0001-MO1",
                                      "0251-0001-MO1", "0252-0107-TO1", "0252-0107-TO1", "0252-0107-TO1",
                                      "0251-0001-MO1", "0251-0001-MO1", "0251-0001-MO1", "0252-0107-TO1",
                                      "0252-0107-TO1", "0251-0001-MO1", "0251-0001-MO1", "0252-0107-TO1",
                                      "0252-0107-TO1", "0251-0001-MO1", "0252-0107-TO1"),
                         SPECIES = c("HM", "PLC", "PLI", "YC", "CW", "PLC", "XC", "YC", "HM", "PLC", "YC",
                                     "CW", "PLC", "YC", "HM", "PLC", "YC", "CW", "PLC", "PLC", "YC",
                                     "CW", "PLC", "PLC", "CW"),
                         PRJ_GRP = c("Haida Gwaii", "Haida Gwaii",
                                     "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii",
                                     "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii",
                                     "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii",
                                     "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii", "Haida Gwaii",
                                     "Haida Gwaii", "Haida Gwaii", "Haida Gwaii"),
                         NO_PLOTS = c(1, 1, 1, 1, 5, 5, 5, 5, 1, 1, 1, 5, 5, 5, 1, 1, 1, 5, 5, 1, 1, 5,
                                      5, 1, 5),
                         PLOT_DED = c(1, 1, 1, 1, 5, 5, 5, 5, 1, 1, 1, 5, 5,
                                      5, 1, 1, 1, 5, 5, 1, 1, 5, 5, 1, 5),
                         PROJ_ID = c("0251", "0251",
                                     "0251", "0251", "0252", "0252", "0252", "0252", "0251", "0251",
                                     "0251", "0252", "0252", "0252", "0251", "0251", "0251", "0252",
                                     "0252", "0251", "0251", "0252", "0252", "0251", "0252"),
                         BGC_ZONE = c("CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH",
                                      "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH", "CWH",
                                      "CWH", "CWH", "CWH", "CWH", "CWH", "CWH"),
                         VHA_WSV = c(1.609, 66.853, 0.416, 19.165, 10.212, 15.896, 0, 0.998, 1.609, 64.303,
                                     9.106, 9.536, 11.897, 0.852, 1.609, 55.208, 1.884, 8.819, 7.573,
                                     44.995, 0, 8.819, 3.558, 38.564, 8.819),
                         VHA_NET = c(1.609, 66.832,
                                     0.416, 19.165, 8.308, 9.452, 0, 0.29, 1.609, 64.282, 9.106, 8.187,
                                     9.381, 0.29, 1.609, 55.208, 1.884, 8.187, 7.526, 44.995, 0, 8.187,
                                     3.536, 38.564, 8.187),
                         VHA_MER = c(1.108, 50.88, 0, 3.267, 7.826,
                                     6.873, 0, 0.034, 1.108, 50.88, 3.267, 7.826, 6.873, 0.034, 1.108,
                                     47.492, 1.432, 7.653, 5.843, 40.322, 0, 7.653, 2.909, 34.925,
                                     7.653),
                         VHA_NETM = c(1.108, 50.879, 0, 3.267, 7.727, 8.478, 0,
                                      0.017, 1.108, 50.879, 3.267, 7.727, 8.478, 0.017, 1.108, 47.492,
                                      1.432, 7.727, 7.084, 40.322, 0, 7.727, 3.328, 34.925, 7.727),
                         VHA_NTW2 = c(1.108, 50.879, 0, 3.267, 7.715, 8.478, 0, 0.017,
                                      1.108, 50.879, 3.267, 7.715, 8.478, 0.017, 1.108, 47.492,
                                      1.432, 7.715, 7.084, 40.322, 0, 7.715, 3.328, 34.925, 7.715),
                         VHA_NTWB = c(1.052, 49.862, 0, 3.038, 7.146, 8.307, 0,
                                      0.016, 1.052, 49.862, 3.038, 7.146, 8.307, 0.016, 1.052,
                                      46.542, 1.332, 7.146, 6.941, 39.516, 0, 7.146, 3.261, 34.226,
                                      7.146),
                         VHA_D = c(1.104, 48.342, 0, 3.255, 7.976, 7.926,
                                   0, 0.017, 1.104, 48.342, 3.255, 7.976, 7.926, 0.017, 1.104,
                                   45.054, 1.427, 7.976, 6.618, 38.092, 0, 7.976, 3.109, 32.873,
                                   7.976),
                         VHA_DW = c(1.103, 47.254, 0, 3.249, 7.803, 7.673,
                                    0, 0.017, 1.103, 47.254, 3.249, 7.803, 7.673, 0.017, 1.103,
                                    43.998, 1.424, 7.803, 6.406, 37.107, 0, 7.803, 3.009, 31.954,
                                    7.803),
                         VHA_DWB = c(1.048, 46.237, 0, 3.02, 7.232, 7.502,
                                     0, 0.016, 1.048, 46.237, 3.02, 7.232, 7.502, 0.016, 1.048,
                                     43.048, 1.323, 7.232, 6.263, 36.301, 0, 7.232, 2.942, 31.255,
                                     7.232),
                         DHA_MER = c(22.155, 1055.377, 0, 40.947, 1216.405,
                                     391.789, 0, 0.425, 22.155, 1055.377, 40.947, 1216.405, 391.789,
                                     0.425, 22.155, 1021.492, 14.324, 1216.405, 330.93, 949.799,
                                     0, 1216.405, 155.468, 829.361, 1216.405),
                         DBH2 = c(4903.295,
                                  212313.163, 2810.889, 73338.53, 32057.141, 88257.705, 0,
                                  4355.327, 4903.295, 197062.916, 31805.622, 28307.021, 60335.943,
                                  3749.92, 4903.295, 158045.949, 6404.303, 24618.142, 34651.284,
                                  120438.929, 0, 24618.142, 16010.758, 99910.635, 24618.142),
                         BA_HA = c(0.385, 16.675, 0.221, 5.76, 2.518, 6.932, 0,
                                   0.342, 0.385, 15.477, 2.498, 2.223, 4.739, 0.295, 0.385,
                                   12.413, 0.503, 1.934, 2.722, 9.459, 0, 1.934, 1.257, 7.847,
                                   1.934),
                         STEMS_HA = c(25, 1201, 100, 1326, 200, 1241, 0, 80,
                                      25, 700, 325, 80, 420, 60, 25, 350, 25, 40, 120, 175, 0,
                                      40, 40, 125, 40),
                         VHA_WSVLF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NETLF = c(0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0),
                         VHA_MERLF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NETMLF = c(0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0),
                         VHA_NTW2LF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NTWBLF = c(0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0),
                         VHA_DLF = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_DWLF = c(0,
                                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                      0, 0, 0, 0, 0),
                         VHA_DWBLF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         DHA_MERLF = c(0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0),
                         DBH2LF = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         BA_HALF = c(0,
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                     0, 0, 0, 0, 0),
                         STEMS_HALF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_WSVDS = c(0,
                                       2.016, 0, 11.062, 0, 3.481, 0.328, 0.903, 0, 2.016, 9.942,
                                       0, 2.207, 0.453, 0, 2.016, 7.844, 0, 1.463, 2.016, 3.027,
                                       0, 0, 0, 0),
                         VHA_NETDS = c(0, 1.996, 0, 10.621, 0, 1.543,
                                       0.052, 0.106, 0, 1.996, 9.501, 0, 1.403, 0, 0, 1.996, 7.482,
                                       0, 1.403, 1.996, 2.876, 0, 0, 0, 0),
                         VHA_MERDS = c(0, 1.613,
                                       0, 6.393, 0, 0.862, 0, 0.158, 0, 1.613, 6.393, 0, 0.862,
                                       0.158, 0, 1.613, 5.534, 0, 0.862, 1.613, 2.457, 0, 0, 0,
                                       0),
                         VHA_NETMDS = c(0, 1.597, 0, 6.097, 0, 1.336, 0, 0, 0,
                                        1.597, 6.097, 0, 1.336, 0, 0, 1.597, 5.275, 0, 1.336, 1.597,
                                        2.334, 0, 0, 0, 0),
                         VHA_NTW2DS = c(0, 1.597, 0, 6.097, 0,
                                        1.336, 0, 0, 0, 1.597, 6.097, 0, 1.336, 0, 0, 1.597, 5.275,
                                        0, 1.336, 1.597, 2.334, 0, 0, 0, 0),
                         VHA_NTWBDS = c(0, 1.565,
                                        0, 5.649, 0, 1.308, 0, 0, 0, 1.565, 5.649, 0, 1.308, 0, 0,
                                        1.565, 4.887, 0, 1.308, 1.565, 2.162, 0, 0, 0, 0),
                         VHA_DDS = c(0,
                                     1.566, 0, 6.369, 0, 1.31, 0, 0, 0, 1.566, 6.369, 0, 1.31,
                                     0, 0, 1.566, 5.513, 0, 1.31, 1.566, 2.448, 0, 0, 0, 0),
                         VHA_DWDS = c(0,
                                      1.546, 0, 6.362, 0, 1.278, 0, 0, 0, 1.546, 6.362, 0, 1.278,
                                      0, 0, 1.546, 5.507, 0, 1.278, 1.546, 2.445, 0, 0, 0, 0),
                         VHA_DWBDS = c(0, 1.513, 0, 5.915, 0, 1.25, 0, 0, 0, 1.513,
                                       5.915, 0, 1.25, 0, 0, 1.513, 5.12, 0, 1.25, 1.513, 2.273,
                                       0, 0, 0, 0),
                         DHA_MERDS = c(0, 16.134, 0, 68.345, 0, 30.9,
                                       0, 0, 0, 16.134, 68.345, 0, 30.9, 0, 0, 16.134, 64.048, 0,
                                       30.9, 16.134, 36.858, 0, 0, 0, 0),
                         DBH2DS = c(0, 8286.568,
                                    0, 30821.46, 0, 19992.834, 2211.486, 3886.211, 0, 8286.568,
                                    26593.62, 0, 11351.628, 1922.092, 0, 8286.568, 20946.575,
                                    0, 6354.67, 8286.568, 7661.398, 0, 0, 0, 0),
                         BA_HADS = c(0,
                                     0.651, 0, 2.421, 0, 1.57, 0.174, 0.305, 0, 0.651, 2.089,
                                     0, 0.892, 0.151, 0, 0.651, 1.645, 0, 0.499, 0.651, 0.602,
                                     0, 0, 0, 0),
                         STEMS_HADS = c(0, 25, 0, 250, 0, 360, 80, 80,
                                        0, 25, 150, 0, 120, 20, 0, 25, 100, 0, 40, 25, 25, 0, 0,
                                        0, 0),
                         VHA_WSVDF = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NETDF = c(0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0),
                         VHA_MERDF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NETMDF = c(0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0),
                         VHA_NTW2DF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_NTWBDF = c(0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0),
                         VHA_DDF = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         VHA_DWDF = c(0,
                                      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                      0, 0, 0, 0, 0),
                         VHA_DWBDF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         DHA_MERDF = c(0,
                                       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                       0, 0, 0, 0, 0),
                         DBH2DF = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         BA_HADF = c(0,
                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                     0, 0, 0, 0, 0),
                         STEMS_HADF = c(0, 0, 0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         UTIL = c(4,
                                  4, 4, 4, 4, 4, 4, 4, 7.5, 7.5, 7.5, 7.5, 7.5, 7.5, 12.5,
                                  12.5, 12.5, 12.5, 12.5, 17.5, 17.5, 17.5, 17.5, 22.5, 22.5),
                         QMD = c(14, 13.297, 5.3, 7.437, 12.656, 8.434, 0, 7.376,
                                 14, 16.773, 9.889, 18.804, 11.982, 7.903, 14, 21.243, 16,
                                 24.8, 16.987, 26.225, 0, 24.8, 20, 28.262, 24.8),
                         QMDLF = c(0,
                                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                                   0, 0, 0, 0, 0),
                         QMDDS = c(0, 18.2, 0, 11.1, 0, 7.45, 5.256,
                                   6.967, 0, 18.2, 13.311, 0, 9.723, 9.8, 0, 18.2, 14.468, 0,
                                   12.6, 18.2, 17.5, 0, 0, 0, 0),
                         QMDDF = c(0, 0, 0, 0, 0, 0,
                                   0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
                         NO_TREES = c(1, 31, 1, 24, 5, 47, 2, 8, 1, 26, 13, 2, 17,
                                      4, 1, 15, 5, 1, 4, 8, 1, 1, 1, 5, 1))
  volsummarybyc <- volSmry_byC(teptable)
  ## for VHA_WSV
  expect_equal(volsummarybyc$VHA_WSV,
               c(88.043, 75.018, 58.701, 44.995, 38.564, 27.106, 22.285,
                 16.392, 12.377, 8.819))
  # for VHA_NET
  expect_equal(volsummarybyc$VHA_NET,
               c(88.022, 74.997, 58.701, 44.995, 38.564, 18.05, 17.858,
                 15.713, 11.723, 8.187))
  # for VHA_MER
  expect_equal(volsummarybyc$VHA_MER,
               c(55.255, 55.255, 50.032, 40.322, 34.925, 14.733, 14.733,
                 13.496, 10.562, 7.653))
  # for VHA_NETM
  expect_equal(volsummarybyc$VHA_NETM,
               c(55.254, 55.254, 50.032, 40.322, 34.925, 16.222, 16.222,
                 14.811, 11.055, 7.727))
  # for VHA_NTW2
  expect_equal(volsummarybyc$VHA_NTW2,
               c(55.254, 55.254, 50.032, 40.322, 34.925, 16.21, 16.21,
                 14.799, 11.043, 7.715))
  # for VHA_NTWB
  expect_equal(volsummarybyc$VHA_NTWB,
               c(53.952, 53.952, 48.926, 39.516, 34.226, 15.469, 15.469,
                 14.087, 10.407, 7.146))
  # for VHA_D
  expect_equal(volsummarybyc$VHA_D,
               c(52.701, 52.701, 47.585, 38.092, 32.873, 15.919, 15.919,
                 14.594, 11.085, 7.976))
  # for VHA_DW
  expect_equal(volsummarybyc$VHA_DW,
               c(51.606, 51.606, 46.525, 37.107, 31.954, 15.493, 15.493,
                 14.209, 10.812, 7.803))
  # for VHA_DWB
  expect_equal(volsummarybyc$VHA_DWB,
               c(50.305, 50.305, 45.419, 36.301, 31.255, 14.750, 14.750,
                 13.495, 10.174, 7.232))
  # for DHA_MER
  expect_equal(volsummarybyc$DHA_MER,
               c(1118.479, 1118.479, 1057.971, 949.799, 829.361, 1608.619,
                 1608.619, 1547.335, 1371.873, 1216.405))
  # for BA_HA
  expect_equal(volsummarybyc$BA_HA,
               c(23.041, 18.36, 13.301, 9.459, 7.847, 9.792, 7.257,
                 4.656, 3.191, 1.934))
  # for STEMS_HA
  expect_equal(volsummarybyc$STEMS_HA,
               c(2652, 1050, 400, 175, 125, 1521, 560, 160, 80, 40))

  ## for all the live falling trees
  for(i in c("VHA_WSVLF", "VHA_NETLF", "VHA_MERLF", "VHA_NETMLF", "VHA_NTW2LF",
             "VHA_NTWBLF", "VHA_DLF", "VHA_DWLF", "VHA_DWBLF", "DHA_MERLF",
             "BA_HALF", "STEMS_HALF")){
    expect_equal(as.numeric(unlist(volsummarybyc[,i, with = FALSE])),
                 rep(0, 10))
  }

  # for VHA_WSVDS
  expect_equal(volsummarybyc$VHA_WSVDS,
               c(13.078, 11.958, 9.86, 5.043, 0, 4.712, 2.660, 1.463,
                 0, 0))
  # for VHA_NETDS
  expect_equal(volsummarybyc$VHA_NETDS,
               c(12.617, 11.497, 9.478, 4.872, 0, 1.701, 1.403, 1.403,
                 0, 0))
  # for VHA_MERDS
  expect_equal(volsummarybyc$VHA_MERDS,
               c(8.006, 8.006, 7.147, 4.070, 0, 1.02, 1.02, 0.862,
                 0, 0))
  # for VHA_NETMDS
  expect_equal(volsummarybyc$VHA_NETMDS,
               c(7.694, 7.694, 6.872, 3.931, 0, 1.336, 1.336, 1.336,
                 0, 0))
  # for VHA_NTW2DS
  expect_equal(volsummarybyc$VHA_NTW2DS,
               c(7.694, 7.694, 6.872, 3.931, 0, 1.336, 1.336, 1.336,
                 0, 0))
  # VHA_NTWBDS
  expect_equal(volsummarybyc$VHA_NTWBDS,
               c(7.214, 7.214, 6.452, 3.727, 0, 1.308, 1.308, 1.308,
                 0, 0))
  # VHA_DDS
  expect_equal(volsummarybyc$VHA_DDS,
               c(7.935, 7.935, 7.079, 4.014, 0, 1.31, 1.31, 1.31,
                 0, 0))
  # for VHA_DWDS
  expect_equal(volsummarybyc$VHA_DWDS,
               c(7.908, 7.908, 7.053, 3.991, 0, 1.278, 1.278, 1.278,
                 0, 0))
  # for VHA_DWBDS
  expect_equal(volsummarybyc$VHA_DWBDS,
               c(7.428, 7.428, 6.633, 3.786, 0, 1.25, 1.25, 1.25,
                 0, 0))
  # for DHA_MERDS
  expect_equal(volsummarybyc$DHA_MERDS,
               c(84.479, 84.479, 80.182, 52.992, 0, 30.9, 30.9, 30.9,
                 0, 0))
  # for BA_HADS
  expect_equal(volsummarybyc$BA_HADS,
               c(3.072, 2.740, 2.296, 1.253, 0, 2.049, 1.043, 0.499,
                 0, 0))
  # for STEMS_HADS
  expect_equal(volsummarybyc$STEMS_HADS,
               c(275, 175, 125, 50, 0, 520, 140, 40, 0, 0))
  ### for dead falling trees
  for(i in c("VHA_WSVDF", "VHA_NETDF", "VHA_MERDF", "VHA_NETMDF",
             "VHA_NTW2DF", "VHA_NTWBDF", "VHA_DDF", "VHA_DWDF",
             "VHA_DWBDF", "DHA_MERDF", "DBH2DF", "BA_HADF", "STEMS_HADF")){
    expect_equal(as.numeric(unlist(volsummarybyc[,i, with = FALSE])),
                 rep(0, 10))
  }

  # for QMD
  expect_equal(volsummarybyc$QMD,
               c(10.518, 14.921, 20.576, 26.234, 28.272, 9.054, 12.845, 19.247,
                 22.536, 24.808))
  # for QMDLF
  expect_equal(volsummarybyc$QMDLF, rep(as.numeric(0), 10))
  # for QMDDS
  expect_equal(volsummarybyc$QMDDS,
               c(11.925, 14.118, 15.293, 17.859, 0, 7.083, 9.737, 12.604, 0,
                 0))
})
